#!/bin/sh

CA_ROOT=ca-root

CLI_AMT=1000
SRV_AMT=13

CLI_PREFIX=cli
SRV_PREFIX=cop

updatecwd() {
    cd "$(dirname $0)"
}

regenerate() {
    echo Removing old CA
    rm -rf $CA_ROOT
    mkdir $CA_ROOT

    echo Generating new root key
    openssl genrsa -des3 -out $CA_ROOT/root.key 2048

    echo Generating new root certificate
    openssl req -x509 -new -nodes -key $CA_ROOT/root.key -sha256 -days 999999 -out $CA_ROOT/root.crt
}

main() {
    updatecwd
    regenerate
}

main
